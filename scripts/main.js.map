{"mappings":"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","sources":["src/main.ts","../../../../Projects/foundry-ts/utils/foundry/settings.ts","src/module.ts","../../../../Projects/foundry-ts/utils/foundry/path.ts","src/apps/tracker.ts","../../../../Projects/foundry-ts/utils/foundry/flags.ts","../../../../Projects/foundry-ts/utils/math.ts","src/combat.ts","../../../../Projects/foundry-ts/utils/foundry/i18n.ts","../../../../Projects/foundry-ts/utils/anonymous/third.ts","../../../../Projects/foundry-ts/utils/foundry/module.ts","../../../../Projects/foundry-ts/utils/anonymous/pf2e.ts","src/thirds/mtb.ts","../../../../Projects/foundry-ts/utils/foundry/combatant.ts","src/config.ts","src/token.ts","../../../../Projects/foundry-ts/utils/foundry/notifications.ts"],"sourcesContent":["import { getSetting, registerSetting } from './@utils/foundry/settings'\r\nimport { MiniTracker } from './apps/tracker'\r\nimport { renderCombatTrackerConfig } from './config'\r\nimport { thirdPartyInitialization } from './@utils/anonymous/third'\r\nimport { hasMTB } from './thirds/mtb'\r\nimport { preUpdateToken } from './token'\r\n\r\nexport let tracker: MiniTracker | null = null\r\n\r\nHooks.once('init', () => {\r\n    // CLIENT SETTINGS\r\n\r\n    registerSetting({\r\n        name: 'enabled',\r\n        scope: 'client',\r\n        config: true,\r\n        type: Boolean,\r\n        default: true,\r\n        onChange: enabled => {\r\n            if (enabled) createTracker()\r\n            else closeTracker()\r\n        },\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'hover',\r\n        scope: 'client',\r\n        config: true,\r\n        type: Boolean,\r\n        default: true,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'delay',\r\n        scope: 'client',\r\n        config: true,\r\n        type: Number,\r\n        default: 250,\r\n    })\r\n\r\n    // CLIENT HIDDEN SETTINGS\r\n\r\n    registerSetting({\r\n        name: 'reversed',\r\n        scope: 'client',\r\n        type: Boolean,\r\n        default: false,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'fake-reversed',\r\n        scope: 'client',\r\n        type: Boolean,\r\n        default: false,\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'coords',\r\n        scope: 'client',\r\n        type: Object,\r\n        default: {},\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'expanded',\r\n        scope: 'client',\r\n        type: String,\r\n        default: 'false',\r\n    })\r\n\r\n    // WORLD SETTINGS\r\n\r\n    registerSetting({\r\n        name: 'turn',\r\n        config: true,\r\n        type: Boolean,\r\n        default: false,\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'showHp',\r\n        config: true,\r\n        type: String,\r\n        default: 'friendly',\r\n        choices: ['none', 'gm', 'friendly', 'all'],\r\n        onChange: hpHooks,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'hpValue',\r\n        config: true,\r\n        type: String,\r\n        default: 'attributes.hp.value',\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'hpMax',\r\n        config: true,\r\n        type: String,\r\n        default: 'attributes.hp.max',\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'dim',\r\n        config: true,\r\n        type: Boolean,\r\n        default: false,\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'dead',\r\n        config: true,\r\n        type: Boolean,\r\n        default: false,\r\n        onChange: refreshTracker,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'immobilize',\r\n        config: true,\r\n        type: Boolean,\r\n        default: false,\r\n        onChange: immobilizeHooks,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'pan',\r\n        config: true,\r\n        type: Boolean,\r\n        default: true,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'select',\r\n        config: true,\r\n        type: Boolean,\r\n        default: true,\r\n    })\r\n\r\n    registerSetting({\r\n        name: 'sheet',\r\n        config: true,\r\n        type: Boolean,\r\n        default: false,\r\n    })\r\n\r\n    thirdPartyInitialization()\r\n})\r\n\r\nHooks.once('ready', () => {\r\n    if (getSetting('enabled')) createTracker()\r\n    if (getSetting('immobilize')) immobilizeHooks(true)\r\n    if (getSetting('hpValue')) hpHooks(true)\r\n})\r\n\r\nHooks.on('renderCombatTrackerConfig', renderCombatTrackerConfig)\r\n\r\nfunction refreshTracker() {\r\n    tracker?.render()\r\n}\r\n\r\nfunction hpHooks(show: unknown) {\r\n    const method = show ? 'on' : 'off'\r\n    Hooks[method]('updateActor', updateActor)\r\n    refreshTracker()\r\n}\r\n\r\nfunction updateActor(actor: Actor, data: DocumentUpdateData<Actor>) {\r\n    const hpValue = getSetting<string>('hpValue')\r\n    const hpMax = getSetting<string>('hpMax')\r\n    if (hpValue !== undefined && hasProperty(data, `system.${hpValue}`)) return refreshTracker()\r\n    if (hpMax !== undefined && hasProperty(data, `system.${hpMax}`)) return refreshTracker()\r\n}\r\n\r\nfunction immobilizeHooks(immobilize: unknown) {\r\n    if (hasMTB()) return\r\n    if (!game.user.isGM) {\r\n        const method = immobilize ? 'on' : 'off'\r\n        Hooks[method]('preUpdateToken', preUpdateToken)\r\n    } else {\r\n        refreshTracker()\r\n    }\r\n}\r\n\r\nfunction createTracker() {\r\n    if (tracker) return\r\n    tracker = new MiniTracker()\r\n    tracker.render(true)\r\n}\r\n\r\nfunction closeTracker() {\r\n    if (tracker) tracker.close()\r\n    tracker = null\r\n}\r\n","import MODULE_ID from '~./src/module'\r\nimport { getSettingLocalizationPath } from './path'\r\n\r\nexport function getSetting<T extends any>(key: string) {\r\n    return game.settings.get(MODULE_ID, key) as T\r\n}\r\n\r\nexport function setSetting(key: string, value: unknown) {\r\n    return game.settings.set(MODULE_ID, key, value)\r\n}\r\n\r\n/**\r\n * options.scope = 'world'\r\n *\r\n * options.config = false\r\n */\r\nexport function registerSetting(\r\n    options: Omit<SettingRegistration, 'choices'> & { choices?: string[] | Record<string, unknown> }\r\n) {\r\n    const name = options.name\r\n    options.scope = options.scope ?? 'world'\r\n    options.config = options.config ?? false\r\n    if (options.config) {\r\n        options.name = getSettingLocalizationPath(name, 'name')\r\n        options.hint = getSettingLocalizationPath(name, 'hint')\r\n    }\r\n    if (Array.isArray(options.choices)) {\r\n        options.choices = options.choices.reduce((choices, choice) => {\r\n            choices[choice] = getSettingLocalizationPath(name, 'choices', choice)\r\n            return choices\r\n        }, {} as Record<string, unknown>)\r\n    }\r\n    game.settings.register(MODULE_ID, name, options as SettingRegistration)\r\n}\r\n\r\n/**\r\n * options.restricted = true\r\n *\r\n * options.icon = 'fas fa-cogs'\r\n */\r\nexport function registerSettingMenu(\r\n    options: RequiredBy<Partial<Omit<SettingSubmenuConfig, 'type'>>, 'name'> & { type: ConstructorOf<FormApplication> }\r\n) {\r\n    const name = options.name\r\n    options.name = getSettingLocalizationPath('menus', name, 'name')\r\n    options.label = getSettingLocalizationPath('menus', name, 'label')\r\n    options.hint = getSettingLocalizationPath('menus', name, 'hint')\r\n    options.restricted = options.restricted ?? true\r\n    options.icon = options.icon ?? 'fas fa-cogs'\r\n    game.settings.registerMenu(MODULE_ID, name, options as SettingSubmenuConfig)\r\n}\r\n\r\nexport function getCombatTrackerConfig() {\r\n    return game.settings.get('core', 'combatTrackerConfig') as { resource: string; skipDefeated: boolean }\r\n}\r\n","export default 'mini-tracker'\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function getSettingLocalizationPath(...path: string[]) {\r\n    return `${MODULE_ID}.settings.${path.join('.')}`\r\n}\r\n\r\nexport function flagsUpdatePath(...path: string[]) {\r\n    return `flags.${MODULE_ID}.${path.join('/')}`\r\n}\r\n\r\nexport function templatePath(...path: string[]) {\r\n    path = path.filter(x => typeof x === 'string')\r\n    return `modules/${MODULE_ID}/templates/${path.join('/')}`\r\n}\r\n\r\nexport function imagePath(...path: string[]) {\r\n    return `modules/${MODULE_ID}/images/${path.join('/')}`\r\n}\r\n","import { getFlag } from '~src/@utils/foundry/flags'\r\nimport { templatePath } from '~src/@utils/foundry/path'\r\nimport { getCombatTrackerConfig, getSetting, setSetting } from '~src/@utils/foundry/settings'\r\nimport { easeInQuad } from '~src/@utils/math'\r\nimport { canNamesBeHidden, getName, playersSeeName, resetFreed, toggleFreed, togglePlayersSeeName } from '~src/combat'\r\nimport { thirdPartyToggleSeeName } from '~src/@utils/anonymous/third'\r\nimport { cloneIcons, hasMTB, showOnTrackerMTB } from '~src/thirds/mtb'\r\nimport { getSameCombatants } from '~src/@utils/foundry/combatant'\r\n\r\nexport class MiniTracker extends Application {\r\n    private _isExpanded: boolean\r\n    private _maxHeight?: number\r\n    private _dragging: boolean\r\n    private _lastCombat: string\r\n    private _lastCombatant: string\r\n    private _lastMoveTime: number\r\n    private _initialPosition: ApplicationPosition\r\n    private _initialPointer: { x: number; y: number } = { x: 0, y: 0 }\r\n    private _combatantHeight?: number\r\n    private _boxHeight?: number\r\n    private _innerMargins?: number\r\n    private _isReversed: boolean\r\n    private _dragHook: (event: MouseEvent) => void\r\n    private _dragEndHook: (event: MouseEvent) => void\r\n    private _expandedDebounce: () => void\r\n    private _coordsDebounce: () => void\r\n    private _menu?: ContextMenu\r\n    private _listHoverHook?: NodeJS.Timeout\r\n    private _resizeHook: (event: MouseEvent) => void\r\n    private _resizeEndHook: (event: MouseEvent) => void\r\n    private _renderHook: number\r\n    private _hoverHook: number\r\n    private _sortable?: Sortable\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        const { left, bottom, top } = getSetting<TrackerCoords>('coords')\r\n        if (typeof left === 'number') this.position.left = left\r\n        if (typeof top === 'number') this.position.top = top\r\n        if (typeof bottom === 'number') this.position.bottom = bottom\r\n\r\n        const expanded = getSetting<string>('expanded')\r\n        this._isExpanded = expanded !== 'false'\r\n        this._maxHeight = expanded !== 'false' && expanded !== 'true' ? parseInt(expanded) : undefined\r\n\r\n        this._isReversed = getSetting<boolean>('reversed')\r\n\r\n        this._dragging = false\r\n\r\n        this._lastCombat = ''\r\n        this._lastCombatant = ''\r\n\r\n        this._lastMoveTime = 0\r\n\r\n        this._dragHook = this.#onDrag.bind(this)\r\n        this._dragEndHook = this.#onDragEnd.bind(this)\r\n\r\n        this._resizeHook = this.#onResize.bind(this)\r\n        this._resizeEndHook = this.#onResizeEnd.bind(this)\r\n\r\n        this._renderHook = Hooks.on('renderCombatTracker', this.#onRender.bind(this))\r\n        this._hoverHook = Hooks.on('hoverToken', this.#onTokenHover.bind(this))\r\n\r\n        this._coordsDebounce = debounce(this.#setCoords, 1000)\r\n        this._expandedDebounce = debounce(this.#setExpanded, 1000)\r\n\r\n        this._initialPosition = this.position\r\n    }\r\n\r\n    static get defaultOptions() {\r\n        return {\r\n            ...super.defaultOptions,\r\n            popOut: false,\r\n            minimizable: false,\r\n            template: templatePath('tracker.html'),\r\n        }\r\n    }\r\n\r\n    get isReversed() {\r\n        return this._isReversed\r\n    }\r\n\r\n    set isReversed(value) {\r\n        this._isReversed = value\r\n        this.render()\r\n        setSetting('reversed', value)\r\n    }\r\n\r\n    get isExpanded() {\r\n        return this._isExpanded\r\n    }\r\n\r\n    set isExpanded(value) {\r\n        this._isExpanded = value\r\n        if (value) this.#expandList()\r\n        else this.#collapseList()\r\n        this.#setExpanded()\r\n    }\r\n\r\n    get isDragging() {\r\n        return this._dragging\r\n    }\r\n\r\n    set isDragging(value) {\r\n        this.element.toggleClass('dragging', value)\r\n        this._dragging = value\r\n    }\r\n\r\n    get moveTick() {\r\n        const now = Date.now()\r\n        if (now - this._lastMoveTime < 1000 / 60) return false\r\n        this._lastMoveTime = now\r\n        return true\r\n    }\r\n\r\n    get innerElement() {\r\n        return this.element.find('.__inner')\r\n    }\r\n\r\n    get combatantElements() {\r\n        return this.element.find('.combatant')\r\n    }\r\n\r\n    get listElement() {\r\n        return this.element.find('.__inner > ol')\r\n    }\r\n\r\n    get combatantHeight() {\r\n        if (this._combatantHeight) return this._combatantHeight\r\n        this._combatantHeight = this.combatantElements.filter('.active').outerHeight(true)\r\n        return this._combatantHeight as number\r\n    }\r\n\r\n    get boxHeight() {\r\n        if (this._boxHeight) return this._boxHeight\r\n        const height = this.element.outerHeight(true)!\r\n        const listHeight = this.listElement.innerHeight()!\r\n        this._boxHeight = height - listHeight\r\n        return this._boxHeight\r\n    }\r\n\r\n    get innerMargins() {\r\n        if (this._innerMargins) return this._innerMargins\r\n        const inner = this.innerElement\r\n        this._innerMargins = parseInt(inner.css('margin-top')) + parseInt(inner.css('margin-bottom'))\r\n        return this._innerMargins\r\n    }\r\n\r\n    get minHeight() {\r\n        return this.combatantHeight + this.boxHeight\r\n    }\r\n\r\n    get maxHeight() {\r\n        return this._maxHeight\r\n    }\r\n\r\n    set maxHeight(value) {\r\n        this._maxHeight = value\r\n        this._expandedDebounce()\r\n    }\r\n\r\n    async getData(options?: Partial<ApplicationOptions> | undefined) {\r\n        const combat = ui.combat.viewed\r\n        if (!combat || !combat.turns.some(x => x.isOwner)) {\r\n            return { hasCombat: false }\r\n        }\r\n\r\n        const isGM = game.user.isGM\r\n        const currentCombatant = combat.combatant\r\n        const showHp = getSetting<ShowHP>('showHp')\r\n        const hpValuePath = getSetting<string>('hpValue')\r\n        const hpMaxPath = getSetting<string>('hpMax')\r\n        const endTurn = getSetting<boolean>('turn')\r\n        const reversed = this.isReversed\r\n        const hideNames = canNamesBeHidden()\r\n        const immobilize = getSetting<boolean>('immobilize') && !hasMTB()\r\n        const sceneId = canvas.scene?.id\r\n        const canPing = game.user.hasPermission('PING_CANVAS')\r\n        const hideDefeated = getSetting<boolean>('dead') && getCombatTrackerConfig().skipDefeated\r\n        const dim = getSetting<boolean>('dim')\r\n\r\n        let hasActive = false\r\n        let hasDecimals = false\r\n\r\n        const turns: Turn[] = []\r\n        for (const [i, combatant] of combat.turns.entries()) {\r\n            if (!combatant.visible) continue\r\n            if (hideDefeated && combatant.defeated && !combatant.hasPlayerOwner) continue\r\n\r\n            let defeated = combatant.isDefeated\r\n\r\n            const effects = new Map()\r\n            if (combatant.actor) {\r\n                for (const effect of combatant.actor.temporaryEffects) {\r\n                    if (effect.getFlag('core', 'statusId') === CONFIG.specialStatusEffects.DEFEATED) defeated = true\r\n                    else if (effect.icon) effects.set(effect.icon, { icon: effect.icon, name: effect.label })\r\n                }\r\n            }\r\n\r\n            const hpValue = !!hpValuePath ? getProperty<number | undefined>(combatant, `actor.system.${hpValuePath}`) : undefined\r\n            const hpMax = !!hpMaxPath ? getProperty<number | undefined>(combatant, `actor.system.${hpMaxPath}`) : undefined\r\n\r\n            let hpHue\r\n            if (hpValue !== undefined && hpMax !== undefined) {\r\n                const x = hpValue / hpMax\r\n                hpHue = easeInQuad(x) * 122 + 3\r\n            }\r\n\r\n            const initiative = combatant.initiative\r\n            const hasRolled = initiative !== null\r\n            if (hasRolled && !Number.isInteger(initiative)) hasDecimals = true\r\n\r\n            const active = i === combat.turn\r\n            if (active) hasActive = true\r\n\r\n            let name = combatant.name\r\n            const playersCanSeeName = playersSeeName(combatant)\r\n\r\n            const hidden = combatant.hidden\r\n            const hasPlayerOwner = combatant.hasPlayerOwner\r\n\r\n            const css = []\r\n            if (active) css.push('active')\r\n            if (hidden) css.push('hidden')\r\n            if (defeated) css.push('defeated')\r\n            if (hideNames && !playersCanSeeName) {\r\n                if (!isGM) name = getName(combatant)\r\n                else if (dim) css.push('anonymous')\r\n            }\r\n\r\n            const turn: Turn = {\r\n                id: combatant.id,\r\n                css: css.join(' '),\r\n                name,\r\n                img: await ui.combat._getCombatantThumbnail(combatant),\r\n                hidden,\r\n                hasPlayerOwner,\r\n                playersCanSeeName,\r\n                freed: !immobilize || combatant === currentCombatant || !!getFlag(combatant, 'freed'),\r\n                canImmobilize: combatant !== currentCombatant,\r\n                defeated,\r\n                canPing: canPing && combatant.sceneId === sceneId,\r\n                effects: Array.from(effects.values()),\r\n                hasRolled,\r\n                initiative,\r\n                owner: combatant.isOwner,\r\n                hpValue,\r\n                hpMax,\r\n                hpHue,\r\n                active,\r\n                showHp:\r\n                    hpValue !== undefined &&\r\n                    showHp !== 'none' &&\r\n                    (isGM || showHp === 'all' || (showHp === 'friendly' && hasPlayerOwner)),\r\n            }\r\n\r\n            turns.push(turn)\r\n        }\r\n\r\n        if (!turns.some(x => x.owner)) {\r\n            return { hasCombat: false }\r\n        }\r\n\r\n        if (!hasActive) {\r\n            const active = Math.min(combat.turn ?? 0, turns.length - 1)\r\n            const combatant = turns[active]\r\n            combatant.active = true\r\n            const css = combatant.css ? combatant.css.split(' ') : []\r\n            css.push('active')\r\n            combatant.css = css.join(' ')\r\n        }\r\n\r\n        const innerCss = []\r\n        if (this.isExpanded) innerCss.push('expanded')\r\n        if (reversed && !getSetting('fake-reversed')) innerCss.push('reversed')\r\n\r\n        const precision = CONFIG.Combat.initiative.decimals\r\n        turns.forEach(combatant => {\r\n            if (combatant.initiative === null) return\r\n            combatant.initiative = (combatant.initiative as number).toFixed(hasDecimals ? precision : 0)\r\n        })\r\n\r\n        return {\r\n            isGM,\r\n            turns,\r\n            endTurn,\r\n            hideNames,\r\n            immobilize,\r\n            showHp: showHp === 'all' || showHp === 'friendly' || (showHp === 'gm' && isGM),\r\n            hasCombat: true,\r\n            round: combat.round,\r\n            arrow: reversed ? 'up' : 'down',\r\n            innerCss: innerCss.join(' '),\r\n            isCurrentTurn: currentCombatant?.isOwner,\r\n        }\r\n    }\r\n\r\n    #onRender() {\r\n        this.render()\r\n    }\r\n\r\n    protected async _render(force?: boolean | undefined, options?: RenderOptions | undefined): Promise<void> {\r\n        await super._render(force, options)\r\n        if (game.user.isGM && showOnTrackerMTB()) cloneIcons(this.listElement)\r\n        Hooks.callAll('renderMiniTracker', this, this.element)\r\n    }\r\n\r\n    render(force?: boolean, options?: any) {\r\n        const combat = ui.combat.viewed\r\n        const isGM = game.user.isGM\r\n        const combatId = combat?.id ?? ''\r\n        const combatant = combat?.combatant\r\n        const token = combatant?.token\r\n\r\n        if (isGM && this._lastCombat === combatId && combatant && this._lastCombatant !== combatant.id) {\r\n            if (token && getSetting('pan') && combatant.visible) {\r\n                canvas.animatePan({ x: token.x, y: token.y })\r\n            }\r\n            if (combatant && !combatant.hasPlayerOwner) {\r\n                if (token?.object && getSetting('select')) token.object.control({ releaseOthers: true })\r\n\r\n                const sheet = combatant.actor?.sheet\r\n                if (sheet && getSetting('sheet')) sheet.render(true)\r\n            }\r\n        }\r\n\r\n        if (isGM && combat && (this._lastCombat !== combatId || (combatant && this._lastCombatant !== combatant.id))) {\r\n            resetFreed(combat)\r\n        }\r\n\r\n        this._lastCombat = combatId\r\n        this._lastCombatant = combatant?.id ?? ''\r\n\r\n        return super.render(force, options)\r\n    }\r\n\r\n    async close(options?: ({ force?: boolean | undefined } & Record<string, unknown>) | undefined): Promise<void> {\r\n        const result = await super.close(options)\r\n        Hooks.off('renderCombatTracker', this._renderHook)\r\n        Hooks.off('hoverToken', this._hoverHook)\r\n        Hooks.call(`closeMiniTracker`, this, this.element)\r\n        return result\r\n    }\r\n\r\n    activateListeners(html: JQuery) {\r\n        const combat = ui.combat.viewed\r\n        if (!combat || !this.innerElement.length) return\r\n\r\n        const tracker = ui.combat\r\n\r\n        html.find('.draggable').on('mousedown', this.#onDragStart.bind(this))\r\n        html.find('.__resizer').on('mousedown', this.#onResizeStart.bind(this))\r\n\r\n        const list = html.find('.__inner > ol')\r\n        list.on('mouseenter', this.#onListHover.bind(this))\r\n        html.on('mouseleave', this.#onListOut.bind(this))\r\n\r\n        html.find('[data-control=trackerReverse]').on('click', () => (this.isReversed = !this.isReversed))\r\n        html.find('[data-control=trackerExpand]').on('click', () => (this.isExpanded = !this.isExpanded))\r\n\r\n        html.find('[data-control=targetCombatant]').on('click', this.#onTarget.bind(this))\r\n\r\n        html.find('.combat-control').on('click', tracker._onCombatControl.bind(tracker))\r\n        html.find('.combatant-control').on('click', tracker._onCombatantControl.bind(tracker))\r\n\r\n        const combatants = list.find('.combatant')\r\n        combatants.on('mouseenter', tracker._onCombatantHoverIn.bind(tracker))\r\n        combatants.on('mouseleave', tracker._onCombatantHoverOut.bind(tracker))\r\n\r\n        if (!game.user.isGM) return\r\n\r\n        this._contextMenu(html)\r\n        this.#makeSortable()\r\n\r\n        html.find('[data-control=trackerSettings]').on('click', () => new CombatTrackerConfig().render(true))\r\n\r\n        if (!hasMTB()) {\r\n            html.find('[data-control=\"toggleImmobilized\"]').on('click', this.#onToggleImmobilized.bind(this))\r\n        }\r\n\r\n        if (canNamesBeHidden() && thirdPartyToggleSeeName) {\r\n            html.find('[data-control=toggle-name-visibility]').on('click', this.#togglePlayersCanSeeName.bind(this))\r\n        }\r\n\r\n        combatants.on('click', tracker._onCombatantMouseDown.bind(tracker))\r\n    }\r\n\r\n    setPosition({ left, top, bottom }: ApplicationPosition) {\r\n        const el = this.element[0]\r\n        const currentPosition = this.position\r\n        const minHeight = this.minHeight\r\n\r\n        const height = el.offsetHeight\r\n        const width = el.offsetWidth\r\n        const winHeight = window.innerHeight\r\n        const winWidth = window.innerWidth\r\n\r\n        left = left ?? winWidth / 2 - width / 2\r\n        top = top ?? winHeight / 2 - height / 2\r\n        bottom = bottom ?? winHeight / 2 - height / 2\r\n\r\n        const maxLeft = Math.max(winWidth - width, 0)\r\n        currentPosition.left = Math.clamped(left, 0, maxLeft)\r\n        el.style.left = currentPosition.left + 'px'\r\n\r\n        if (this.isReversed) {\r\n            if (bottom + minHeight > winHeight) bottom = winHeight - minHeight\r\n            if (bottom < 0) bottom = 0\r\n            el.style.bottom = bottom + 'px'\r\n            currentPosition.bottom = bottom\r\n            currentPosition.top = winHeight - bottom - minHeight\r\n        } else {\r\n            if (top + minHeight > winHeight) top = winHeight - minHeight\r\n            if (top < 0) top = 0\r\n            el.style.top = top + 'px'\r\n            currentPosition.top = top\r\n            currentPosition.bottom = winHeight - top - minHeight\r\n        }\r\n\r\n        this.#calculateHeight()\r\n\r\n        return currentPosition\r\n    }\r\n\r\n    _contextMenu($html: JQuery) {\r\n        this._menu = ContextMenu.create(this, $html, '.combatant', ui.combat._getEntryContextOptions())\r\n    }\r\n\r\n    #getCombatantFromEvent(event: JQuery.ClickEvent<any, any, HTMLElement>) {\r\n        const $combatant = $(event.currentTarget).closest('.combatant')\r\n        const id = $combatant.attr('data-combatant-id')!\r\n        return ui.combat.viewed?.combatants.get(id)\r\n    }\r\n\r\n    #onTarget(event: JQuery.ClickEvent<any, any, HTMLElement>) {\r\n        event.preventDefault()\r\n\r\n        const combatant = this.#getCombatantFromEvent(event)\r\n        const token = combatant?.token\r\n\r\n        if (!token) return\r\n\r\n        const current = Array.from(game.user.targets).map(x => x.id)\r\n        const targets = event.shiftKey ? current : current.filter(x => x === token.id)\r\n        const index = targets.indexOf(token.id)\r\n\r\n        if (index !== -1) targets.splice(index, 1)\r\n        else targets.push(token.id)\r\n\r\n        game.user.updateTokenTargets(targets)\r\n    }\r\n\r\n    #onToggleImmobilized(event: JQuery.ClickEvent<any, any, HTMLElement>) {\r\n        event.preventDefault()\r\n        const combatant = this.#getCombatantFromEvent(event)\r\n        if (combatant) toggleFreed(combatant)\r\n    }\r\n\r\n    async #togglePlayersCanSeeName(event: JQuery.ClickEvent<any, any, HTMLElement>) {\r\n        event.preventDefault()\r\n        const combatant = this.#getCombatantFromEvent(event)\r\n        if (!combatant) return\r\n\r\n        if (event.shiftKey && combatant.actor && combatant.actor.isToken && game.combat?.scene) {\r\n            getSameCombatants(combatant).forEach(togglePlayersSeeName)\r\n        } else {\r\n            togglePlayersSeeName(combatant)\r\n        }\r\n    }\r\n\r\n    #makeSortable() {\r\n        this._sortable = new Sortable(this.listElement[0], {\r\n            animation: 150,\r\n            draggable: '.combatant',\r\n            delay: 50,\r\n            onEnd: this.#onSortEnd.bind(this),\r\n        })\r\n    }\r\n\r\n    #onSortEnd(event: Sortable.SortableEvent) {\r\n        const id = event.item.dataset.combatantId\r\n        const combat = ui.combat.viewed\r\n        const oldIndex = /** @type {number} */ event.oldIndex\r\n        const newIndex = /** @type {number} */ event.newIndex\r\n\r\n        if (!combat || oldIndex === newIndex || !id) return\r\n\r\n        const turns = combat.turns\r\n        if (turns.length <= 1) return\r\n\r\n        const others = turns.filter(x => x.id !== id)\r\n        const prevCombatants = others.slice(0, newIndex)\r\n        const nextCombatants = others.slice(newIndex)\r\n\r\n        let prevInit = prevCombatants.reverse().find(x => x.initiative != null)?.initiative\r\n        let nextInit = nextCombatants.find(x => x.initiative != null)?.initiative\r\n\r\n        if (nextInit == null && prevInit == null) {\r\n            nextInit = 0\r\n            prevInit = 2\r\n        } else if (nextInit == null) {\r\n            nextInit = /** @type {number} */ prevInit! - 2\r\n        } else if (prevInit == null) {\r\n            prevInit = /** @type {number} */ nextInit + 2\r\n        }\r\n\r\n        // @ts-ignore\r\n        const newInit = (prevInit + nextInit) / 2\r\n        combat.setInitiative(id, newInit)\r\n    }\r\n\r\n    #onResizeStart(event: JQuery.MouseDownEvent) {\r\n        event.preventDefault()\r\n\r\n        window.addEventListener('mousemove', this._resizeHook)\r\n        window.addEventListener('mouseup', this._resizeEndHook)\r\n    }\r\n\r\n    #onResize(event: MouseEvent) {\r\n        event.preventDefault()\r\n\r\n        if (!this.moveTick) return\r\n\r\n        let maxHeight: number | undefined = event.clientY - (this.position.top ?? 0)\r\n        if (this.isReversed) maxHeight = -(maxHeight - this.minHeight)\r\n\r\n        maxHeight = Math.max(maxHeight, this.minHeight)\r\n\r\n        this.#calculateHeight(maxHeight)\r\n\r\n        const combatants = this.combatantElements.length\r\n        const expected = combatants * this.combatantHeight + this.boxHeight\r\n\r\n        if (maxHeight >= expected) maxHeight = undefined\r\n\r\n        this.maxHeight = maxHeight\r\n    }\r\n\r\n    #onResizeEnd(event: MouseEvent) {\r\n        event.preventDefault()\r\n\r\n        window.removeEventListener('mousemove', this._resizeHook)\r\n        window.removeEventListener('mouseup', this._resizeEndHook)\r\n    }\r\n\r\n    #onDragStart(event: JQuery.MouseDownEvent) {\r\n        event.preventDefault()\r\n\r\n        this.isDragging = true\r\n        this._initialPosition = duplicate(this.position)\r\n        this._initialPointer = { x: event.clientX, y: event.clientY }\r\n\r\n        window.addEventListener('mousemove', this._dragHook)\r\n        window.addEventListener('mouseup', this._dragEndHook)\r\n    }\r\n\r\n    #onDrag(event: MouseEvent) {\r\n        event.preventDefault()\r\n\r\n        if (!this.moveTick) return\r\n\r\n        const pos = this._initialPosition\r\n        const cursor = this._initialPointer\r\n        const left = (pos.left ?? 0) + (event.clientX - cursor.x)\r\n\r\n        if (this.isReversed) {\r\n            this.setPosition({\r\n                left,\r\n                bottom: (pos.bottom ?? 0) - (event.clientY - cursor.y),\r\n            })\r\n        } else {\r\n            this.setPosition({\r\n                left,\r\n                top: (pos.top ?? 0) + (event.clientY - cursor.y),\r\n            })\r\n        }\r\n\r\n        this._coordsDebounce()\r\n    }\r\n\r\n    #onDragEnd(event: MouseEvent) {\r\n        event.preventDefault()\r\n\r\n        this.isDragging = false\r\n        this.#calculateHeight()\r\n\r\n        window.removeEventListener('mousemove', this._dragHook)\r\n        window.removeEventListener('mouseup', this._dragEndHook)\r\n    }\r\n\r\n    #onTokenHover(token: Token, hovered: boolean) {\r\n        const combatant = token.combatant\r\n        if (!combatant) return\r\n        const combatants = this.combatantElements\r\n        combatants.removeClass('hovered')\r\n        if (hovered) combatants.filter(`[data-combatant-id=\"${combatant.id}\"]`).addClass('hovered')\r\n    }\r\n\r\n    #setExpanded() {\r\n        setSetting('expanded', !this.isExpanded ? 'false' : this.maxHeight || 'true')\r\n    }\r\n\r\n    #expandList() {\r\n        this.innerElement.addClass('expanded')\r\n        this.#calculateHeight()\r\n    }\r\n\r\n    #collapseList() {\r\n        if (this._listHoverHook) clearTimeout(this._listHoverHook)\r\n        this.innerElement.removeClass('expanded')\r\n        this._menu?.close({ animate: false })\r\n    }\r\n\r\n    #onListHover() {\r\n        if (this.isExpanded || !getSetting('hover')) return\r\n        const delay = getSetting<number>('delay')\r\n        if (delay) this._listHoverHook = setTimeout(() => this.#expandList(), delay)\r\n        else this.#expandList()\r\n    }\r\n\r\n    #onListOut() {\r\n        if (this.isExpanded) return\r\n        this.#collapseList()\r\n    }\r\n\r\n    #calculateHeight(tmpHeight?: number) {\r\n        const inner = this.innerElement\r\n        if (!inner.length) return\r\n\r\n        const winHeight = window.innerHeight\r\n\r\n        let maxHeight\r\n\r\n        if (this.isReversed) maxHeight = winHeight - (this.position.bottom ?? 0)\r\n        else maxHeight = winHeight - (this.position.top ?? 0)\r\n\r\n        if (tmpHeight && tmpHeight < maxHeight) {\r\n            maxHeight = tmpHeight\r\n        } else if (this.maxHeight && this.maxHeight < maxHeight) {\r\n            maxHeight = this.maxHeight\r\n        }\r\n\r\n        maxHeight = Math.max(maxHeight, this.minHeight)\r\n        maxHeight -= this.innerMargins\r\n\r\n        inner.css('max-height', maxHeight)\r\n\r\n        if (this.isExpanded) this.#scrollToCurrent()\r\n    }\r\n\r\n    #scrollToCurrent() {\r\n        const list = this.listElement\r\n        const height = list.innerHeight()!\r\n        if (height === list.prop('scrollHeight')) return\r\n        const active = list.find('> .active')[0]\r\n        list.scrollTop(active.offsetTop - height / 2 + active.offsetHeight / 2)\r\n    }\r\n\r\n    #setCoords() {\r\n        const { left, top, bottom } = this.position\r\n        setSetting('coords', { left, top, bottom })\r\n    }\r\n}\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function hasModuleFlag(doc: foundry.abstract.Document) {\r\n    // @ts-ignore\r\n    return !!doc.flags && MODULE_ID in doc.flags\r\n}\r\n\r\nexport function getFlag<T extends unknown>(doc: foundry.abstract.Document, key: string, ...keys: string[]) {\r\n    keys.unshift(key)\r\n    return doc.getFlag(MODULE_ID, keys.join('.')) as T | undefined\r\n}\r\n\r\n/**\r\n * @template {foundry.Document} T\r\n * @param {T} doc\r\n * @param {string} key\r\n * @param {any} value\r\n * @returns T\r\n */\r\nexport function setFlag(doc: foundry.abstract.Document, key: string, value: unknown) {\r\n    return doc.setFlag(MODULE_ID, key, value)\r\n}\r\n","export function easeInQuad(x: number): number {\r\n    return x * x\r\n}\r\n\r\nexport function easeInSine(x: number): number {\r\n    return 1 - Math.cos((x * Math.PI) / 2)\r\n}\r\n","import { getFlag, setFlag } from './@utils/foundry/flags'\r\nimport { localize } from './@utils/foundry/i18n'\r\nimport { flagsUpdatePath } from './@utils/foundry/path'\r\nimport {\r\n    thirdPartyCanNamesBeHidden,\r\n    thirdPartyGetName,\r\n    thirdPartyPlayersSeeName,\r\n    thirdPartyToggleSeeName,\r\n} from './@utils/anonymous/third'\r\n\r\nexport function canNamesBeHidden() {\r\n    return thirdPartyCanNamesBeHidden?.() ?? false\r\n}\r\n\r\nexport function playersSeeName(combatant: Combatant) {\r\n    return combatant.hasPlayerOwner || (thirdPartyPlayersSeeName?.(combatant) ?? true)\r\n}\r\n\r\nexport function togglePlayersSeeName(combatant: Combatant) {\r\n    return thirdPartyToggleSeeName?.(combatant)\r\n}\r\n\r\nexport function getName(combatant: Combatant) {\r\n    return thirdPartyGetName?.(combatant) ?? localize('unknown')\r\n}\r\n\r\nexport function resetFreed(combat: Combat) {\r\n    const flag = flagsUpdatePath('freed')\r\n    const updates = combat.combatants.map(x => ({ _id: x._id, [flag]: false }))\r\n    combat.updateEmbeddedDocuments('Combatant', updates)\r\n}\r\n\r\nexport function preDeleteCombat(combat: Combat) {\r\n    if (combat === ui.combat.viewed) resetFreed(combat)\r\n}\r\n\r\nexport function toggleFreed(combatant: Combatant) {\r\n    const immobilized = getFlag<boolean>(combatant, 'freed')\r\n    setFlag(combatant, 'freed', !immobilized)\r\n}\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function localize(key: string, data?: Record<string, string | number>) {\r\n    key = `${MODULE_ID}.${key}`\r\n    if (data) return game.i18n.format(key, data)\r\n    return game.i18n.localize(key)\r\n}\r\n\r\nexport function subLocalize(subKey: string) {\r\n    const fn = (key: string, data?: Record<string, string>) => localize(`${subKey}.${key}`, data)\r\n    Object.defineProperty(fn, 'key', {\r\n        get() {\r\n            return subKey\r\n        },\r\n        enumerable: false,\r\n        configurable: false,\r\n    })\r\n    return fn as ((key: string, data?: Record<string, string>) => string) & { key: string }\r\n}\r\n","import { getModuleApi } from '../foundry/module'\r\nimport { tokenSetsNameVisibility } from './pf2e'\r\n\r\nexport let thirdPartyCanNamesBeHidden: () => boolean\r\nexport let thirdPartyPlayersSeeName: ((combatant: Combatant) => boolean) | undefined\r\nexport let thirdPartyToggleSeeName: ((combatant: Combatant) => Promise<unknown>) | undefined\r\nexport let thirdPartyGetName: ((combatant: Combatant) => string) | undefined\r\n\r\nexport function thirdPartyInitialization() {\r\n    const anonymous = getModuleApi('anonymous')\r\n    if (anonymous) {\r\n        thirdPartyCanNamesBeHidden = () => true\r\n        thirdPartyPlayersSeeName = anonymous.playersSeeName\r\n        thirdPartyToggleSeeName = anonymous.toggleSeeName\r\n        thirdPartyGetName = anonymous.getName\r\n    } else if (game.system.id === 'pf2e') {\r\n        thirdPartyCanNamesBeHidden = tokenSetsNameVisibility\r\n        thirdPartyPlayersSeeName = combatant => (combatant as CombatantPF2e).playersCanSeeName\r\n    }\r\n}\r\n","import MODULE_ID from '~./src/module'\r\n\r\ntype OwnModule = 'anonymous' | 'idleuh'\r\n\r\ntype ReturnedModule<T extends Record<string, any> = Record<string, any>> = Module<T> | undefined\r\ntype ReturnedModuleApi<T extends Record<string, any> = Record<string, any>> = Module<T>['api'] | undefined\r\n\r\nexport function getModule(id: 'anonymous'): ReturnedModule<AnonymousApi>\r\nexport function getModule(id: 'idleuh'): ReturnedModule<IdleuhApi>\r\nexport function getModule(id: 'pf2e-hero-actions'): ReturnedModule<HeroActionsApi>\r\nexport function getModule(id: string): ReturnedModule\r\nexport function getModule(id: string | OwnModule) {\r\n    return game.modules.get(id)\r\n}\r\n\r\nexport function getCurrentModule() {\r\n    return getModule(MODULE_ID)!\r\n}\r\n\r\nexport function getModuleApi(id: 'anonymous'): ReturnedModuleApi<AnonymousApi>\r\nexport function getModuleApi(id: 'idleuh'): ReturnedModuleApi<IdleuhApi>\r\nexport function getModuleApi(id: 'pf2e-hero-actions'): ReturnedModuleApi<HeroActionsApi>\r\nexport function getModuleApi(id: string): ReturnedModuleApi\r\nexport function getModuleApi(id: string | OwnModule) {\r\n    return getModule(id)?.api\r\n}\r\n","export function tokenSetsNameVisibility() {\r\n    if (game.system.id !== 'pf2e') return false\r\n    if (game.settings.settings.has('pf2e.metagame.tokenSetsNameVisibility'))\r\n        return !!game.settings.get('pf2e', 'metagame.tokenSetsNameVisibility')\r\n    return !!game.settings.get('pf2e', 'metagame_tokenSetsNameVisibility')\r\n}\r\n","import { getModule } from '~src/@utils/foundry/module'\r\n\r\nconst MODULE_ID = 'monks-tokenbar'\r\n\r\nexport function hasMTB() {\r\n    return getModule(MODULE_ID)?.active\r\n}\r\n\r\nexport function cloneIcons(list: JQuery) {\r\n    const ol = ui.combat.element.find<HTMLOListElement>('#combat-tracker')\r\n    const combatants = ol.find<HTMLLIElement>('.combatant:has([data-control=\"toggleMovement\"])')\r\n\r\n    combatants.each(function () {\r\n        const li = $(this)\r\n        const id = li.attr('data-combatant-id')!\r\n        const icon = li.find<HTMLAnchorElement>('[data-control=\"toggleMovement\"]')\r\n        const clone = icon.clone(true)\r\n\r\n        clone.on('click', () => icon.toggleClass('active'))\r\n        icon.on('click', () => clone.toggleClass('active'))\r\n\r\n        list.find(`[data-combatant-id=\"${id}\"] [data-control=\"toggleDefeated\"]`).before(clone)\r\n    })\r\n}\r\n\r\nexport function showOnTrackerMTB() {\r\n    return hasMTB() && !!game.settings.get(MODULE_ID, 'show-on-tracker')\r\n}\r\n","export function getSameCombatants(combatant: Combatant) {\r\n    return combatant.combat.turns.filter(x => x.actorId === combatant.actorId)\r\n}\r\n","import { localize } from './@utils/foundry/i18n'\r\nimport { getSetting, setSetting } from './@utils/foundry/settings'\r\n\r\nexport function renderCombatTrackerConfig(config: CombatTrackerConfig, html: JQuery) {\r\n    injectHTML(html)\r\n    addEvents(html)\r\n    html.css('height', 'auto')\r\n}\r\n\r\nfunction addEvents(html: JQuery) {\r\n    html.find<HTMLInputElement>('input[name=\"hideDeads\"]').on('change', function () {\r\n        const checked = $(this).is(':checked')\r\n        setSetting('dead', checked)\r\n    })\r\n}\r\n\r\nfunction injectHTML(html: JQuery) {\r\n    const checked = getSetting('dead') ? 'checked' : ''\r\n\r\n    let content = '<div class=\"form-group\">'\r\n    content += `<label>${localize('settings.dead.name')}</label>`\r\n    content += `<input type=\"checkbox\" name=\"hideDeads\" ${checked}>`\r\n    content += `<p class=\"notes\">${localize('settings.dead.hint')}</p>`\r\n    content += '</div>'\r\n\r\n    html.find('.form-group').last().after(content)\r\n}\r\n","import { getFlag } from './@utils/foundry/flags'\r\nimport { warn } from './@utils/foundry/notifications'\r\nimport { tracker } from './main'\r\n\r\nexport function preUpdateToken(token: TokenDocument, data: Partial<foundry.data.TokenData>) {\r\n    if (!tracker || !('x' in data || 'y' in data)) return\r\n\r\n    const combatant = token.combatant\r\n    const combat = ui.combat.viewed\r\n    if (!combat || !combatant || combat.combatant === combatant || getFlag(combatant, 'freed')) return\r\n\r\n    delete data.x\r\n    delete data.y\r\n\r\n    warn('immobilized')\r\n}\r\n","import { localize } from './i18n'\r\n\r\nexport function notify(\r\n    str: string,\r\n    arg1?: 'warning' | 'info' | 'error' | boolean | Record<string, string>,\r\n    arg2?: boolean | Record<string, string>,\r\n    arg3?: boolean\r\n) {\r\n    const type = typeof arg1 === 'string' ? arg1 : 'info'\r\n    const data = typeof arg1 === 'object' ? arg1 : typeof arg2 === 'object' ? arg2 : undefined\r\n    const permanent = typeof arg1 === 'boolean' ? arg1 : typeof arg2 === 'boolean' ? arg2 : arg3 ?? false\r\n\r\n    ui.notifications.notify(localize(str, data), type, { permanent })\r\n}\r\n\r\nexport function warn(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'warning', arg1, arg2)\r\n}\r\n\r\nexport function info(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'info', arg1, arg2)\r\n}\r\n\r\nexport function error(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'error', arg1, arg2)\r\n}\r\n"],"names":[],"version":3,"file":"main.js.map"}